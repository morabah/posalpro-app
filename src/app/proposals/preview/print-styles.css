/*
 * PosalPro MVP2 - Proposals Preview Print Optimization Styles
 * Enhanced print styles for professional proposal presentation
 */

@media print {
  /* PDF.js canvas print helpers */
  .pdf-page {
    page-break-after: always !important;
    break-after: page !important;
  }

  .print-datasheets-container {
    width: 100% !important;
  }

  .print-datasheets-container canvas {
    width: 100% !important;
    height: auto !important;
    display: block !important;
  }

  .print-datasheet-wrapper {
    page-break-before: always !important;
    break-before: page !important;
    margin: 0 !important;
    padding: 12pt 0 !important;
  }

  .print-datasheet-header h1 { font-size: 16pt !important; margin-bottom: 6pt !important; }
  .print-datasheet-header h2 { font-size: 13pt !important; margin-bottom: 4pt !important; }
  .print-datasheet-header p { font-size: 9pt !important; margin-bottom: 8pt !important; }

  /* Page setup for professional printing */
  @page {
    margin: 0.2in;
    size: A4;
  }

  /* Page frame for print - sleek, close to paper edge */
  body {
    margin: 0;
    padding: 42pt 0 34pt 0; /* space for header/footer in print */
    min-height: 100vh;
    box-sizing: border-box;
    position: relative;
  }

  /* Create page border using pseudo-element */
  html::before,
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 1pt solid rgba(0, 0, 0, 0.75);
    pointer-events: none;
    z-index: 1000;
    box-sizing: border-box;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Inner content frame */
  .max-w-4xl {
    border: 0; /* remove inner frame for a cleaner, modern look */
    margin: 8pt;
    padding: 8pt;
    position: relative;
    z-index: 1;
  }

  /* Hide interactive elements */
  .print\\:hidden {
    display: none !important;
  }

  /* Hide only interactive UI elements (avoid hiding content rows) */
  button,
  input,
  select,
  textarea,
  [role="button"],
  .print\\:hidden {
    display: none !important;
  }

  /* Hide decorative icons and UI glyphs in print */
  svg,
  [data-icon],
  img[alt*="icon" i],
  img[class*="icon" i] {
    display: none !important;
  }

  /* Hide small decorative dots in headings */
  .company-info h2 .rounded-full,
  .section-container h2 .rounded-full {
    display: none !important;
  }

  /* Removed broad table-hiding rule to keep section product tables visible */

  /* Hide UI elements within sections but keep content (use no-print in markup) */

  /* Hide specific UI containers */
  .mt-3.p-3.bg-blue-50,
  .grid.grid-cols-3.gap-4.pt-4.border-t.border-green-200 {
    display: none !important;
  }

  /* Section visibility is now controlled in markup; keep defaults */

  /* Ensure product tables are visible (fix display semantics) */
  .section-container table,
  .section-container .compact-table,
  .section-container .min-w-full {
    display: table !important;
  }
  .section-container thead {
    display: table-header-group !important;
  }
  .section-container tbody {
    display: table-row-group !important;
  }
  .section-container tr {
    display: table-row !important;
  }
  .section-container th,
  .section-container td {
    display: table-cell !important;
  }

  /* Optimize backgrounds for print */
  .print\\:bg-white {
    background: white !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Remove shadows for cleaner print */
  .print\\:shadow-none {
    box-shadow: none !important;
  }

  /* Remove any remaining shadows in print */
  [class*="shadow"],
  .shadow, .shadow-sm, .shadow-md, .shadow-lg, .shadow-xl, .shadow-2xl {
    box-shadow: none !important;
  }

  /* Enhanced typography for print - slim and elegant */
  body {
    font-size: 10pt;
    line-height: 1.2;
    color: black;
    margin: 0;
    padding: 42pt 0 34pt 0; /* ensure padding remains after overrides */
  }

  h1 { font-size: 18pt; margin-bottom: 8pt; line-height: 1.1; }
  h2 { font-size: 14pt; margin-bottom: 6pt; line-height: 1.1; }
  h3 { font-size: 12pt; margin-bottom: 4pt; line-height: 1.1; }

  /* Remove default margins from all elements */
  * {
    margin-top: 0;
    margin-bottom: 0;
  }

  /* Numbering now handled in JSX for reliability across browsers */

  /* Add minimal margins only where needed */
  .section-container {
    margin-bottom: 6pt !important;
  }

  /* Table optimizations - Ultra-compact cells */
  table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 8pt;
    font-size: 9pt;
  }

  th, td {
    border: 0.5pt solid #ddd;
    padding: 2pt 3pt;
    text-align: left;
    vertical-align: top;
    line-height: 1.1;
  }

  th {
    background-color: #f5f5f5 !important;
    font-weight: bold;
    font-size: 8pt;
    padding: 2pt 3pt;
  }

  /* Ultra-compact table cells */
  .compact-table td {
    padding: 1pt 2pt;
    font-size: 8pt;
    line-height: 1.0;
  }

  .compact-table th {
    padding: 2pt;
    font-size: 7pt;
    line-height: 1.0;
  }

  /* Prevent page breaks in table rows */
  tr {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Prevent page breaks in important sections */
  .break-inside-avoid {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Section containers - keep together when possible */
  .section-container {
    page-break-inside: avoid;
    break-inside: avoid;
    margin-bottom: 15pt;
  }

  /* Subtotal sections - keep with their tables */
  .subtotal-section {
    page-break-before: avoid;
    break-before: avoid;
    margin-top: 8pt;
    padding-top: 6pt;
  }

  /* Ensure subtotals stay with their parent section */
  .section-container .subtotal-section {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Ultra-compact spacing for print */
  .section-container {
    padding: 8pt !important;
    margin-bottom: 8pt !important;
  }

  /* Reduce header spacing in print */
  .section-container h2 {
    margin-bottom: 4pt !important;
    font-size: 12pt !important;
    line-height: 1.2 !important;
  }

  /* Compact content areas */
  .section-container .bg-gray-50 {
    padding: 4pt !important;
    margin-bottom: 4pt !important;
    font-size: 8pt !important;
    line-height: 1.1 !important;
  }

  /* Remove extra margins from section headers */
  .section-container .flex.items-center.justify-between {
    margin-bottom: 4pt !important;
  }

  /* Compact table spacing */
  .section-container table {
    margin-bottom: 8pt !important;
  }

  /* Reduce spacing between table and subtotals */
  .subtotal-section {
    margin-top: 4pt !important;
    padding-top: 3pt !important;
  }

  /* Total section emphasis */
  .total-section {
    border: 2pt solid #28a745;
    padding: 12pt;
    margin: 20pt 0;
    background-color: #f8f9fa !important;
  }

  /* Terms section formatting */
  .terms-section {
    margin-top: 30pt;
    page-break-before: avoid;
  }

  /* Ensure proper spacing */
  .section-spacing {
    margin-bottom: 20pt;
  }

  /* Header consistency - Ultra-compact */
  .print-header {
    border-bottom: 1pt solid #333;
    padding-bottom: 4pt;
    margin-bottom: 8pt;
  }

  /* Compact proposal header */
  .proposal-header {
    margin-bottom: 6pt !important;
    padding-bottom: 4pt !important;
  }

  /* Compact company info */
  .company-info {
    margin-bottom: 4pt !important;
  }

  /* Compact proposal details */
  .proposal-details {
    margin-bottom: 4pt !important;
  }

  /* Remove extra spacing from flex containers */
  .flex {
    gap: 2pt !important;
  }

  /* Compact button spacing */
  .print\\:hidden + * {
    margin-top: 2pt !important;
  }

  /* Ultra-compact grid spacing */
  .grid {
    gap: 4pt !important;
  }

  /* Reduce spacing in flex containers */
  .flex.items-start.gap-3 {
    gap: 2pt !important;
  }

  /* Compact text spacing */
  p, div {
    margin-bottom: 2pt !important;
  }

  /* Remove extra spacing from motion divs */
  .motion-div {
    margin-bottom: 4pt !important;
  }

  /* Compact section spacing */
  .section-container + .section-container {
    margin-top: 4pt !important;
  }

  /* Page break for datasheets */
  .page-break-before {
    page-break-before: always;
    break-before: page;
  }

  /* Neutralize circular UI badges (keep text only) */
  .section-container td .rounded-full,
  .section-container .rounded-full {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }
  .section-container td .rounded-full.w-8.h-8,
  .section-container .rounded-full.w-8.h-8 {
    width: auto !important;
    height: auto !important;
    border-radius: 0 !important;
    padding: 0 !important;
  }

  /* Hide datasheet selector in print */
  .print\\:hidden { display: none !important; }

  /* Datasheet selection visibility handled via .no-print in markup */

  /* Hide fallback "No Datasheets Available" block */
  .rounded-xl.border.border-gray-200.bg-gray-50.p-8.mb-6 {
    display: none !important;
  }

  /* Show datasheet pages only in print */
  .print\\:block {
    display: none;
  }

  @media print {
    .print\\:block {
      display: block !important;
    }
  }

  /* PDF iframe styling for print */
  @media print {
    iframe {
      width: 100% !important;
      height: auto !important;
      min-height: 100vh !important;
      border: 1pt solid #ddd !important;
      page-break-inside: auto;
      break-inside: auto;
      display: block !important;
    }

    /* Allow PDF pages to flow naturally */
    .page-break-before {
      page-break-before: always !important;
      break-before: page !important;
      height: auto !important;
      min-height: auto !important;
    }

    /* Ensure PDF container doesn't constrain height */
    .page-break-before > div {
      min-height: auto !important;
      height: auto !important;
      overflow: visible !important;
    }

    /* Remove height constraints on PDF containers */
    .page-break-before .min-h-screen {
      min-height: auto !important;
      height: auto !important;
    }

    /* Ensure PDF iframe can expand to show all pages */
    .page-break-before iframe {
      height: auto !important;
      min-height: 100vh !important;
      max-height: none !important;
      width: 100% !important;
      display: block !important;
    }

    /* Remove overflow hidden that might clip PDF content */
    .page-break-before > div {
      overflow: visible !important;
    }

    /* Force PDF to display in single page mode for better print layout */
    .page-break-before iframe {
      transform: scale(1) !important;
      transform-origin: top left !important;
    }
  }
}

/* Enhanced animations for web view */
/* Print utility classes */
@media screen {
  .print-only { display: none !important; }
}
@media print {
  .no-print { display: none !important; }
  .print-only { display: revert !important; }

  /* Print header and footer */
  .print-header-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 36pt;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6pt 12pt;
    background: #fff;
    border-bottom: 1pt solid rgba(0,0,0,0.6);
    z-index: 1001;
  }

  .print-header-bar .print-logo {
    height: 18pt;
    width: auto;
    display: inline-block;
  }

  .print-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 28pt;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4pt 12pt;
    background: #fff;
    border-top: 1pt solid rgba(0,0,0,0.6);
    z-index: 1001;
    font-size: 9pt;
    color: #444;
    text-align: center;
  }

  .print-footer .page-number::after {
    content: counter(page) " of " counter(pages) " | " attr(data-title);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.animate-slide-in-right {
  animation: slideInRight 0.3s ease-out;
}

.animate-pulse-gentle {
  animation: pulse 2s ease-in-out infinite;
}

/* Responsive enhancements */
@media (max-width: 640px) {
  .mobile-stack {
    flex-direction: column;
    gap: 1rem;
  }

  .mobile-full-width {
    width: 100%;
  }

  .mobile-text-sm {
    font-size: 0.875rem;
  }
}
